<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A practical seismological database library in Python.">
  
  
  <title>Pisces</title>
  

  <link rel="shortcut icon" href="./img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="./css/theme.css" type="text/css" />
  <link rel="stylesheet" href="./css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/highlight.css">
  <link href="./nowrap.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "None";
  </script>
  
  <script src="./js/jquery-2.1.1.min.js"></script>
  <script src="./js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="./js/highlight.pack.js"></script>
  <script src="./js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> Pisces</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href=".">Home</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#pisces">Pisces</a></li>
                
                    <li><a class="toctree-l4" href="#overview">Overview</a></li>
                
                    <li><a class="toctree-l4" href="#what-does-it-look-like">What does it look like?</a></li>
                
                    <li><a class="toctree-l4" href="#installation">Installation</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorial</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="tutorial.tables/">Database Tables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="tutorial.queries/">Using the Database</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="tutorial.waveforms/">Import/Export Waveforms</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="tutorial.flatfiles/">Import/Export Flat Files</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="api/">API Documentation</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>About</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="about.roadmap/">Roadmap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="about.license/">License</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="about.group/">User's Group</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">Pisces</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Home</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/jkmacc-lanl/pisces" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="pisces">Pisces</h1>
<p>A practical seismological database library in Python.</p>
<hr />
<h2 id="overview">Overview</h2>
<p>Pisces connects your Python analysis environment to a seismological database.</p>
<p><strong>Manage and analyze data in the same language</strong><br />
Don't use separate data-management language, like SQL or shell scripts. Just use Python, and connect to <a href="http://www.scipy.org/about.html">SciPy</a>, <a href="http://www.obspy.org">ObsPy</a>, <a href="http://www.earth.northwestern.edu/~xlou/aimbat.html">AIMBAT</a>, <a href="http://webservices.rm.ingv.it/pyTDMT/">pyTDMT</a>, <a href="https://github.com/miili/StreamPick">StreamPick</a>, and the rest of the scientific Python ecosystem.</p>
<p><strong>Use common open-source technologies and standards</strong><br />
SQL relational databases, <a href="http://www.python.org">Python</a>, <a href="http://www.sqlalchemy.org">SQLAlchemy</a>, and the <a href="http://www.scipy.org/about.html">SciPy stack</a> are widely-used, free, and open-source technologies.
Because of this, you can leverage knowledge from sites, like <a href="http://stackoverflow.com/search?q=sqlalchemy">StackOverflow</a>, and other disciplines, like web development, for database examples, troubleshooting, or tricks.</p>
<p><strong>Write portable, extensible, and scalable code</strong><br />
Python is multi-platform, SQLAlchemy is database-agnostic, and the whole stack is free and open-source.  Write code that will not eventually have to be abandoned due to project size, system architecture, or budgetary or licensing concerns.</p>
<h3 id="features">Features</h3>
<ul>
<li>Import/export waveforms directly to/from your database.</li>
<li>Easy importing/exporting of text "flat-file" data tables.</li>
<li>Build database queries using Python objects and methods (<a href="http:/www.sqlalchemy.org">SQLAlchemy</a>), not by concatenating SQL strings.</li>
<li>Integration with <a href="http://www.obspy.org">ObsPy</a>.</li>
<li>Geographic filtering of results.</li>
</ul>
<hr />
<h2 id="what-does-it-look-like">What does it look like?</h2>
<h3 id="define-tables">Define tables</h3>
<p>Name your Center for Seismic Studies (CSS) 3.0 tables in a module (e.g. mytables.py),
inheriting structure and constraints.
This just needs to be done once per table name.</p>
<h4 id="mytablespy">mytables.py</h4>
<pre><code>import pisces.schema.css3 as css

class Affiliation(css.Affiliation):
    __tablename__ = 'affiliation'

class Site(css.Site):
    __tablename__ = 'site'

class Origin(css.Origin):
    __tablename__ = 'origin'

class Wfdisc(css.Wfdisc):
    __tablename__ = 'Wfdisc'
</code></pre>
<h3 id="importing-tables">Importing tables</h3>
<p>Import your tables.</p>
<pre><code>from mytables import Site, Origin
from mytables import Affiliation as Affil
</code></pre>
<p>Import/reflect arbitrary existing database tables.</p>
<pre><code>import pisces as ps

session = ps.db_connect('sqlite:///mydb.sqlite')
sometable, othertable = ps.get_tables(session.bind, ['sometable','othertable'])
</code></pre>
<h3 id="querying-tables">Querying tables</h3>
<p>Query all stations from the CREST seismic deployment, using SQLAlchemy</p>
<pre><code>q = session.query(Site).filter(Site.ondate.between(2008001, 2008365))
csites = q.filter(Site.sta == Affil.sta).filter(Affil.net == 'XP').all()
</code></pre>
<p>Query for western US earthquakes, using a Pisces query builder</p>
<pre><code>import pisces.request as req
wus_quakes = req.get_events(session, Origin, region=(-115, -105, 35, 45), mag={'mb': (4, None)})
</code></pre>
<p>Add Albuquerque ANMO to the site table, and the Chelyabinsk bolide to the origin table.</p>
<pre><code>ANMO = Site(sta='ANMO', lat=34.9459, lon=-106.4572, elev=1.85)
bolide = Origin(orid=1, lat=55.15, lon=61.41, mb=2.7, etype='xm')
session.add_all([ANMO, bolide])
session.commit()
</code></pre>
<p>Edit a Site, delete an Origin.</p>
<pre><code>session.query(Site).filter(Site.sta == 'MK31').update({'lat': 42.5})
session.query(Origin).filter(Origin.orid = 1001).delete()
session.commit()
session.close()
</code></pre>
<h3 id="get-a-waveform">Get a waveform</h3>
<p>Get an ObsPy <a href="http://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.html#obspy.core.trace.Trace">Trace</a> object from your waveform description (wfdisc) table.</p>
<pre><code>from mytables import Wfdisc

wf = session.query(Wfdisc).filter(Wfdisc.sta == 'ANMO').first()  
tr = wf.to_trace()  
tr.plot()
</code></pre>
<p><img alt="ANMO waveform" src="./data/ANMO.png" title="ANMO waveform" /></p>
<hr />
<h2 id="installation">Installation</h2>
<p>Requires:</p>
<ul>
<li>NumPy</li>
<li>ObsPy</li>
<li>SQLAlchemy&gt;0.7</li>
<li>C, Fortran compiler</li>
</ul>
<p>Install from <a href="https://pypi.python.org/pypi">PyPI</a>:</p>
<pre><code>pip install pisces-db
</code></pre>
<p>Install current master from GitHub:</p>
<pre><code>pip install git+https://github.com/jkmacc-LANL/pisces
</code></pre>
<p><a href="https://github.com/igrigorik/ga-beacon"><img alt="Analytics" src="https://ga-beacon.appspot.com/UA-48246702-1/pisces/readme?pixel" /></a></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.tables/" class="btn btn-neutral float-right" title="Database Tables"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/jkmacc-lanl/pisces" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
        <span style="margin-left: 15px"><a href="tutorial.tables/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>

<!--
MkDocs version : 0.15.0.dev
Build Date UTC : 2015-12-08 17:49:12.352849
-->
